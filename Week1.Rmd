---
title: "Causes of Death "
subtitle: "Presentation"
author: 
institute: "Department of Econometrics and Business Statistics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: css/style.css
    yolo: FALSE
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r , echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(datasets)
library(kableExtra)
library(dplyr)
library(magrittr)
library(ggplot2)
```


class: center, middle

# Introduction 

Research Questions 

```{r read_csv, echo = FALSE, message = FALSE, warning = FALSE}
Deaths <- read_csv("Data/annual-number-of-deaths-by-cause.csv")
```

---

# Deaths - HIV/AIDS

- .blue[How have death from **HIV / AIDS** changed over time in the world ? ]
- .blue[What is the top 5 countries with the highest death rates from **HIV / AIDS** and the death trends from those countries? ]
- .blue[What are the preventive measures for **HIV / AIDS** ? ]


---

.content-box-soft[ 
Deaths rates from HIV/AIDS in the world
]

```{r HIV_AIDS,  echo = FALSE, message = FALSE, warning = FALSE }
HIV_AIDS <- Deaths %>% 
  select( Entity, Code, Year, `Deaths - HIV/AIDS - Sex: Both - Age: All Ages (Number)`) %>%
  rename(Deaths_HIV_AIDS = `Deaths - HIV/AIDS - Sex: Both - Age: All Ages (Number)` )%>%
  filter(!is.na(Deaths_HIV_AIDS))
                
                 
```


```{r World_trend, echo = FALSE, message = FALSE, warning = FALSE }
HIV_AIDS %>% filter (Entity == "World")%>%
  mutate(round_Deaths_HIV_AIDS = Deaths_HIV_AIDS/1000)%>%
  ggplot(aes(x= Year, 
             y = round_Deaths_HIV_AIDS))+
  geom_line(linetype = "dashed", color = "blue", size =1 ) +
  geom_point(color = "blue", size = 3)+
  labs(y = "Number of Deaths from HIV/AIDS per 100,000 people",
       x = "Year")+
  ggtitle("Deaths rates from HIV/AIDS")+
  theme_minimal()
```


---
class: left, top

.content-box-soft[ 
Top 5 countries with the highest average death rates from HIV / AIDS
]


```{r average_HIV,   echo = FALSE, message = FALSE, warning = FALSE}
#disable scientific notation
options(scipen=999)
#calculate average death rates per nation
HIV_AIDS_nation <- HIV_AIDS %>% 
  filter(!Entity %in% c("Asia", "Africa", "African Region", "Central Asia", "Central Europe", "Central Europe, Eastern Europe, and Central Asia",
                        "Central Latin America", "Central sub-Saharan Africa", "Commonwealth High Income", "Commonwealth Low Income", 
                        "Commonwealth Middle Income" , "East Asia","East Asia & Pacific - World Bank region", "Eastern Europe", 
                        "Eastern Mediterranean Region", "Eastern sub-Saharan Africa" ,"Europe & Central Asia - World Bank region", 
                        "European Region", "European Union" , "G20", "Low SDI", "High SDI", "Low-middle SDI",  "High-income", 
                        "High-income Asia Pacific", "High-income North America" , "High-middle SDI","Latin America & Caribbean - World Bank region" ,
                        "Middle SDI","Commonwealth", "African Union", "Southern sub-Saharan Africa", "Region of the Americas",
                        "South-East Asia Region" , "Southeast Asia","Southeast Asia, East Asia, and Oceania", "South Asia - World Bank region",
                        "Sub-Saharan Africa - World Bank region" , "Western Europe", "Western Pacific Region" , "Western sub-Saharan Africa", 
                        "World" , "World Bank High Income", "World Bank Low Income","World Bank Lower Middle Income" ,
                        "World Bank Upper Middle Income"))
mean_HIV_AIDS <- HIV_AIDS_nation %>% 
  group_by(Entity)  %>% 
  summarise(`Average Death Rates from HIV/AIDS` =  mean(Deaths_HIV_AIDS, na.rm = TRUE)) %>%
  arrange(-`Average Death Rates from HIV/AIDS`)

mean_HIV_AIDS <- mean_HIV_AIDS %>% 
  mutate_if(is.numeric, round, digits=0)

mean_HIV_AIDS <- head(mean_HIV_AIDS,5)

knitr::kable(mean_HIV_AIDS,
             col.names = gsub("[.]", " ",
                              names(mean_HIV_AIDS)))
```

---
class: left, top

.content-box-soft[ 
Death trend in those top 5 countries with the highest average death rates from HIV / AIDS
]


```{r HIV_AIDS_nations, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Number of Deaths from HIV/AIDS in Countries"}
HIV_AIDS %>% filter (Entity %in% c("South Africa", "Kenya","Tanzania", "India" , "Nigeria" ))%>%
  mutate(round_Deaths_HIV_AIDS = Deaths_HIV_AIDS/1000)%>%
  ggplot(aes(x= Year, 
             y = round_Deaths_HIV_AIDS,
             colour = Entity))+
  geom_line(linetype = "dashed", size =1 ) +
  geom_point(size = 2)+
  labs(y = "Number of Deaths from HIV/AIDS per 100,000 people",
       x = "Year")+
  ggtitle("Deaths rates from HIV/AIDS")+
  theme_minimal()
```


---
class: left, top


.content-box-soft[ 
Rate of HIV/AIDS-related deaths averted due to Antiretroviral Therapy (ART) introduced in the 1980s
]



```{r ART, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Effectiveness of Antiretroviral therapy on HIV / AIDS over the years"}
ART <- read_csv("Data/hivaids-deaths-and-averted-due-to-art.csv")

ART  %>% filter (Entity %in% c( "Nigeria", "South Africa", "Kenya","Tanzania", "India"  ))%>%
  mutate(Deaths_averted = `Deaths averted due to ART - estimate`/1000)  %>%
   ggplot(aes(x= Year, 
             y = Deaths_averted, 
             colour = Entity))+
  geom_line(linetype = "dashed", size =1 ) +
  geom_point( size = 2)+
  labs(y = "Number of HIV/AIDS deaths averted per 100,000 people",
       x = "Year")+
  ggtitle("Number of HIV/AIDS deaths averted due to ART")+
  theme_minimal()
```



---
class: left, top
.content-box-soft[ 
Other measures on HIV prevention
]

- .blue[Contraception measures]

- .blue[Education on HIV/AIDS]

---
class: left, top

# Death - Malaria 

-1. How is the trend of **malaria** change across the years in the WORLD ? 

-2. What is the 5 countries with highest death rates for malaria

-3. What is the preventive measures for malaria? 


---
class: left, top

# Malaria world trend 

```{r, echo = FALSE, preserve = TRUE}

malaria_data <- read.csv("Data/annual-number-of-deaths-by-cause (1).csv")

```

.pullleft1[
```{r, echo = FALSE, preserve = TRUE, fig.cap ="Malaria world trend"}

malaria_data <- malaria_data %>%
  select(Entity, Year, Deaths...Malaria...Sex..Both...Age..All.Ages..Number.) %>%
  rename(Malaria = Deaths...Malaria...Sex..Both...Age..All.Ages..Number.) %>%
  rename(Country = Entity) %>%
  filter(Year >= 2000) 

malaria_world<- malaria_data %>%
  filter(Country == "World") 

ggplot(malaria_world, aes( x = Year, y = Malaria)) +
  geom_line()+
  scale_y_continuous(labels = scales::comma)




```
]

- The world trend of Malaria death rate was **decreasing** from 2000 to 2019


---
class: left, top

# Top 5 Countries with **highest** Malaria death rate 


.center2[
```{r, echo = FALSE, preserve = TRUE}

malaria_mean <- malaria_data %>%
  group_by(Country) %>%
  summarize(Mean = mean(Malaria)) %>%
  mutate(Mean = ceiling(Mean)) %>%
  arrange(-Mean) %>%
  filter(Country != "World") %>%
  filter(Country != "Sub-Saharan Africa (WB)") %>%
  filter(Country != "African Region (WHO)") %>%
  filter(Country != "World Bank Lower Middle Income") %>%
  filter(Country != "World Bank Low Income") %>%
  filter(Country != "Democratic Republic of Congo") %>%
  filter(Country != "South-East Asia Region (WHO)") %>%
  filter(Country != "South Asia (WB)") %>%
  filter(Country != "G20") 

knitr::kable(head(malaria_mean, 5))

#knitr::kable(caption = "Top 5 Countries with highest Malaria death rate")


```
]

---
class: left, top

# Trending of the top 5 Countries 

.pullleft1[
```{r, echo = FALSE, preserve = TRUE, fig.cap ="Malaria world trend", fig.pos= "H"}

malaria_top5 <- malaria_data %>%
  filter(Country %in% c("Nigeria", "India", "Uganda", "Burkina Faso", "Cote d'Ivoire")) 

ggplot(malaria_top5, aes( x = Year, y = Malaria, color = Country)) +
  geom_line()+
  scale_y_continuous(labels = scales::comma)





```
]

-The trend of malaria death rate from 2000 to 2019 was **decreasing** for the top 5 countries

---
class: left, top

# Reasons for high death rate of malaria in these countries

-hot and humid weather

.content-box-soft[ 
* Temperature higher or equal to 21â„ƒ is the most suitable condition for one of the fatal malaria parasite to grow into vector. 
]


-lack of comprehensive report system

.content-box-soft[ 
* In India, hospital and clinic do not report malaria cases to corresponding government organisation
]


---
class: left, top

# Preventive measures for Malaria

-Maldives: must report confirmed malaria cases to government

-Sri Lanka: set up mobile malaria clinics to detect cases 

-RTS.S subunit vaccine (still in testing stage)

-use of insecticide

-insecticide-treated net

---

```{r endslide, child="EndSlide/endslide.Rmd"}
```  
